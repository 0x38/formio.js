!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.formiojs=t()}}(function(){var t;return function e(t,n,r){function o(u,s){if(!n[u]){if(!t[u]){var a="function"==typeof require&&require;if(!s&&a)return a(u,!0);if(i)return i(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[u]={exports:{}};t[u][0].call(f.exports,function(e){var n=t[u][1][e];return o(n?n:e)},f,f.exports,e,t,n,r)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,n,r){(function(e){!function(e){"use strict";if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof r&&"object"==typeof n)n.exports=e();else if("function"==typeof t&&t.amd)t(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("This environment was not anticipated by Q. Please file a bug.");var o="undefined"!=typeof window?window:self,i=o.Q;o.Q=e(),o.Q.noConflict=function(){return o.Q=i,this}}}(function(){"use strict";function t(t){return function(){return V.apply(t,arguments)}}function n(t){return t===Object(t)}function r(t){return"[object StopIteration]"===rt(t)||t instanceof G}function o(t,e){if(Q&&e.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(ot)){for(var n=[],r=e;r;r=r.source)r.stack&&n.unshift(r.stack);n.unshift(t.stack);var o=n.join("\n"+ot+"\n");t.stack=i(o)}}function i(t){for(var e=t.split("\n"),n=[],r=0;r<e.length;++r){var o=e[r];a(o)||u(o)||!o||n.push(o)}return n.join("\n")}function u(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function s(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function a(t){var e=s(t);if(!e)return!1;var n=e[0],r=e[1];return n===$&&r>=H&&ct>=r}function c(){if(Q)try{throw new Error}catch(t){var e=t.stack.split("\n"),n=e[0].indexOf("@")>0?e[1]:e[2],r=s(n);if(!r)return;return $=r[0],r[1]}}function f(t,e,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e+" is deprecated, use "+n+" instead.",new Error("").stack),t.apply(t,arguments)}}function l(t){return t instanceof v?t:g(t)?O(t):I(t)}function p(){function t(t){e=t,i.source=t,K(n,function(e,n){l.nextTick(function(){t.promiseDispatch.apply(t,n)})},void 0),n=void 0,r=void 0}var e,n=[],r=[],o=tt(p.prototype),i=tt(v.prototype);if(i.promiseDispatch=function(t,o,i){var u=J(arguments);n?(n.push(u),"when"===o&&i[1]&&r.push(i[1])):l.nextTick(function(){e.promiseDispatch.apply(e,u)})},i.valueOf=function(){if(n)return i;var t=m(e);return b(t)&&(e=t),t},i.inspect=function(){return e?e.inspect():{state:"pending"}},l.longStackSupport&&Q)try{throw new Error}catch(u){i.stack=u.stack.substring(u.stack.indexOf("\n")+1)}return o.promise=i,o.resolve=function(n){e||t(l(n))},o.fulfill=function(n){e||t(I(n))},o.reject=function(n){e||t(S(n))},o.notify=function(t){e||K(r,function(e,n){l.nextTick(function(){n(t)})},void 0)},o}function d(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var e=p();try{t(e.resolve,e.reject,e.notify)}catch(n){e.reject(n)}return e.promise}function h(t){return d(function(e,n){for(var r=0,o=t.length;o>r;r++)l(t[r]).then(e,n)})}function v(t,e,n){void 0===e&&(e=function(t){return S(new Error("Promise does not support operation: "+t))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=tt(v.prototype);if(r.promiseDispatch=function(n,o,i){var u;try{u=t[o]?t[o].apply(r,i):e.call(r,o,i)}catch(s){u=S(s)}n&&n(u)},r.inspect=n,n){var o=n();"rejected"===o.state&&(r.exception=o.reason),r.valueOf=function(){var t=n();return"pending"===t.state||"rejected"===t.state?r:t.value}}return r}function y(t,e,n,r){return l(t).then(e,n,r)}function m(t){if(b(t)){var e=t.inspect();if("fulfilled"===e.state)return e.value}return t}function b(t){return t instanceof v}function g(t){return n(t)&&"function"==typeof t.then}function w(t){return b(t)&&"pending"===t.inspect().state}function _(t){return!b(t)||"fulfilled"===t.inspect().state}function j(t){return b(t)&&"rejected"===t.inspect().state}function k(){it.length=0,ut.length=0,at||(at=!0)}function x(t,n){at&&("object"==typeof e&&"function"==typeof e.emit&&l.nextTick.runAfter(function(){-1!==Y(ut,t)&&(e.emit("unhandledRejection",n,t),st.push(t))}),ut.push(t),n&&"undefined"!=typeof n.stack?it.push(n.stack):it.push("(no stack) "+n))}function E(t){if(at){var n=Y(ut,t);-1!==n&&("object"==typeof e&&"function"==typeof e.emit&&l.nextTick.runAfter(function(){var r=Y(st,t);-1!==r&&(e.emit("rejectionHandled",it[n],t),st.splice(r,1))}),ut.splice(n,1),it.splice(n,1))}}function S(t){var e=v({when:function(e){return e&&E(this),e?e(t):this}},function(){return this},function(){return{state:"rejected",reason:t}});return x(e,t),e}function I(t){return v({when:function(){return t},get:function(e){return t[e]},set:function(e,n){t[e]=n},"delete":function(e){delete t[e]},post:function(e,n){return null===e||void 0===e?t.apply(void 0,n):t[e].apply(t,n)},apply:function(e,n){return t.apply(e,n)},keys:function(){return nt(t)}},void 0,function(){return{state:"fulfilled",value:t}})}function O(t){var e=p();return l.nextTick(function(){try{t.then(e.resolve,e.reject,e.notify)}catch(n){e.reject(n)}}),e.promise}function T(t){return v({isDef:function(){}},function(e,n){return q(t,e,n)},function(){return l(t).inspect()})}function A(t,e,n){return l(t).spread(e,n)}function P(t){return function(){function e(t,e){var u;if("undefined"==typeof StopIteration){try{u=n[t](e)}catch(s){return S(s)}return u.done?l(u.value):y(u.value,o,i)}try{u=n[t](e)}catch(s){return r(s)?l(s.value):S(s)}return y(u,o,i)}var n=t.apply(this,arguments),o=e.bind(e,"next"),i=e.bind(e,"throw");return o()}}function D(t){l.done(l.async(t)())}function R(t){throw new G(t)}function U(t){return function(){return A([this,N(arguments)],function(e,n){return t.apply(e,n)})}}function q(t,e,n){return l(t).dispatch(e,n)}function N(t){return y(t,function(t){var e=0,n=p();return K(t,function(r,o,i){var u;b(o)&&"fulfilled"===(u=o.inspect()).state?t[i]=u.value:(++e,y(o,function(r){t[i]=r,0===--e&&n.resolve(t)},n.reject,function(t){n.notify({index:i,value:t})}))},void 0),0===e&&n.resolve(t),n.promise})}function B(t){if(0===t.length)return l.resolve();var e=l.defer(),n=0;return K(t,function(r,o,i){function u(t){e.resolve(t)}function s(){n--,0===n&&e.reject(new Error("Can't get fulfillment value from any promise, all promises were rejected."))}function a(t){e.notify({index:i,value:t})}var c=t[i];n++,y(c,u,s,a)},void 0),e.promise}function C(t){return y(t,function(t){return t=Z(t,l),y(N(Z(t,function(t){return y(t,W,W)})),function(){return t})})}function L(t){return l(t).allSettled()}function F(t,e){return l(t).then(void 0,void 0,e)}function M(t,e){return l(t).nodeify(e)}var Q=!1;try{throw new Error}catch(z){Q=!!z.stack}var $,G,H=c(),W=function(){},X=function(){function t(){for(var t,e;r.next;)r=r.next,t=r.task,r.task=void 0,e=r.domain,e&&(r.domain=void 0,e.enter()),n(t,e);for(;a.length;)t=a.pop(),n(t);i=!1}function n(e,n){try{e()}catch(r){if(s)throw n&&n.exit(),setTimeout(t,0),n&&n.enter(),r;setTimeout(function(){throw r},0)}n&&n.exit()}var r={task:void 0,next:null},o=r,i=!1,u=void 0,s=!1,a=[];if(X=function(t){o=o.next={task:t,domain:s&&e.domain,next:null},i||(i=!0,u())},"object"==typeof e&&"[object process]"===e.toString()&&e.nextTick)s=!0,u=function(){e.nextTick(t)};else if("function"==typeof setImmediate)u="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var c=new MessageChannel;c.port1.onmessage=function(){u=f,c.port1.onmessage=t,t()};var f=function(){c.port2.postMessage(0)};u=function(){setTimeout(t,0),f()}}else u=function(){setTimeout(t,0)};return X.runAfter=function(t){a.push(t),i||(i=!0,u())},X}(),V=Function.call,J=t(Array.prototype.slice),K=t(Array.prototype.reduce||function(t,e){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){e=this[n++];break}if(++n>=r)throw new TypeError}for(;r>n;n++)n in this&&(e=t(e,this[n],n));return e}),Y=t(Array.prototype.indexOf||function(t){for(var e=0;e<this.length;e++)if(this[e]===t)return e;return-1}),Z=t(Array.prototype.map||function(t,e){var n=this,r=[];return K(n,function(o,i,u){r.push(t.call(e,i,u,n))},void 0),r}),tt=Object.create||function(t){function e(){}return e.prototype=t,new e},et=t(Object.prototype.hasOwnProperty),nt=Object.keys||function(t){var e=[];for(var n in t)et(t,n)&&e.push(n);return e},rt=t(Object.prototype.toString);G="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var ot="From previous event:";l.resolve=l,l.nextTick=X,l.longStackSupport=!1,"object"==typeof e&&e&&e.env&&e.env.Q_DEBUG&&(l.longStackSupport=!0),l.defer=p,p.prototype.makeNodeResolver=function(){var t=this;return function(e,n){e?t.reject(e):arguments.length>2?t.resolve(J(arguments,1)):t.resolve(n)}},l.Promise=d,l.promise=d,d.race=h,d.all=N,d.reject=S,d.resolve=l,l.passByCopy=function(t){return t},v.prototype.passByCopy=function(){return this},l.join=function(t,e){return l(t).join(e)},v.prototype.join=function(t){return l([this,t]).spread(function(t,e){if(t===e)return t;throw new Error("Can't join: not the same: "+t+" "+e)})},l.race=h,v.prototype.race=function(){return this.then(l.race)},l.makePromise=v,v.prototype.toString=function(){return"[object Promise]"},v.prototype.then=function(t,e,n){function r(e){try{return"function"==typeof t?t(e):e}catch(n){return S(n)}}function i(t){if("function"==typeof e){o(t,s);try{return e(t)}catch(n){return S(n)}}return S(t)}function u(t){return"function"==typeof n?n(t):t}var s=this,a=p(),c=!1;return l.nextTick(function(){s.promiseDispatch(function(t){c||(c=!0,a.resolve(r(t)))},"when",[function(t){c||(c=!0,a.resolve(i(t)))}])}),s.promiseDispatch(void 0,"when",[void 0,function(t){var e,n=!1;try{e=u(t)}catch(r){if(n=!0,!l.onerror)throw r;l.onerror(r)}n||a.notify(e)}]),a.promise},l.tap=function(t,e){return l(t).tap(e)},v.prototype.tap=function(t){return t=l(t),this.then(function(e){return t.fcall(e).thenResolve(e)})},l.when=y,v.prototype.thenResolve=function(t){return this.then(function(){return t})},l.thenResolve=function(t,e){return l(t).thenResolve(e)},v.prototype.thenReject=function(t){return this.then(function(){throw t})},l.thenReject=function(t,e){return l(t).thenReject(e)},l.nearer=m,l.isPromise=b,l.isPromiseAlike=g,l.isPending=w,v.prototype.isPending=function(){return"pending"===this.inspect().state},l.isFulfilled=_,v.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},l.isRejected=j,v.prototype.isRejected=function(){return"rejected"===this.inspect().state};var it=[],ut=[],st=[],at=!0;l.resetUnhandledRejections=k,l.getUnhandledReasons=function(){return it.slice()},l.stopUnhandledRejectionTracking=function(){k(),at=!1},k(),l.reject=S,l.fulfill=I,l.master=T,l.spread=A,v.prototype.spread=function(t,e){return this.all().then(function(e){return t.apply(void 0,e)},e)},l.async=P,l.spawn=D,l["return"]=R,l.promised=U,l.dispatch=q,v.prototype.dispatch=function(t,e){var n=this,r=p();return l.nextTick(function(){n.promiseDispatch(r.resolve,t,e)}),r.promise},l.get=function(t,e){return l(t).dispatch("get",[e])},v.prototype.get=function(t){return this.dispatch("get",[t])},l.set=function(t,e,n){return l(t).dispatch("set",[e,n])},v.prototype.set=function(t,e){return this.dispatch("set",[t,e])},l.del=l["delete"]=function(t,e){return l(t).dispatch("delete",[e])},v.prototype.del=v.prototype["delete"]=function(t){return this.dispatch("delete",[t])},l.mapply=l.post=function(t,e,n){return l(t).dispatch("post",[e,n])},v.prototype.mapply=v.prototype.post=function(t,e){return this.dispatch("post",[t,e])},l.send=l.mcall=l.invoke=function(t,e){return l(t).dispatch("post",[e,J(arguments,2)])},v.prototype.send=v.prototype.mcall=v.prototype.invoke=function(t){return this.dispatch("post",[t,J(arguments,1)])},l.fapply=function(t,e){return l(t).dispatch("apply",[void 0,e])},v.prototype.fapply=function(t){return this.dispatch("apply",[void 0,t])},l["try"]=l.fcall=function(t){return l(t).dispatch("apply",[void 0,J(arguments,1)])},v.prototype.fcall=function(){return this.dispatch("apply",[void 0,J(arguments)])},l.fbind=function(t){var e=l(t),n=J(arguments,1);return function(){return e.dispatch("apply",[this,n.concat(J(arguments))])}},v.prototype.fbind=function(){var t=this,e=J(arguments);return function(){return t.dispatch("apply",[this,e.concat(J(arguments))])}},l.keys=function(t){return l(t).dispatch("keys",[])},v.prototype.keys=function(){return this.dispatch("keys",[])},l.all=N,v.prototype.all=function(){return N(this)},l.any=B,v.prototype.any=function(){return B(this)},l.allResolved=f(C,"allResolved","allSettled"),v.prototype.allResolved=function(){return C(this)},l.allSettled=L,v.prototype.allSettled=function(){return this.then(function(t){return N(Z(t,function(t){function e(){return t.inspect()}return t=l(t),t.then(e,e)}))})},l.fail=l["catch"]=function(t,e){return l(t).then(void 0,e)},v.prototype.fail=v.prototype["catch"]=function(t){return this.then(void 0,t)},l.progress=F,v.prototype.progress=function(t){return this.then(void 0,void 0,t)},l.fin=l["finally"]=function(t,e){return l(t)["finally"](e)},v.prototype.fin=v.prototype["finally"]=function(t){return t=l(t),this.then(function(e){return t.fcall().then(function(){return e})},function(e){return t.fcall().then(function(){throw e})})},l.done=function(t,e,n,r){return l(t).done(e,n,r)},v.prototype.done=function(t,n,r){var i=function(t){l.nextTick(function(){if(o(t,u),!l.onerror)throw t;l.onerror(t)})},u=t||n||r?this.then(t,n,r):this;"object"==typeof e&&e&&e.domain&&(i=e.domain.bind(i)),u.then(void 0,i)},l.timeout=function(t,e,n){return l(t).timeout(e,n)},v.prototype.timeout=function(t,e){var n=p(),r=setTimeout(function(){e&&"string"!=typeof e||(e=new Error(e||"Timed out after "+t+" ms"),e.code="ETIMEDOUT"),n.reject(e)},t);return this.then(function(t){clearTimeout(r),n.resolve(t)},function(t){clearTimeout(r),n.reject(t)},n.notify),n.promise},l.delay=function(t,e){return void 0===e&&(e=t,t=void 0),l(t).delay(e)},v.prototype.delay=function(t){return this.then(function(e){var n=p();return setTimeout(function(){n.resolve(e)},t),n.promise})},l.nfapply=function(t,e){return l(t).nfapply(e)},v.prototype.nfapply=function(t){var e=p(),n=J(t);return n.push(e.makeNodeResolver()),this.fapply(n).fail(e.reject),e.promise},l.nfcall=function(t){var e=J(arguments,1);return l(t).nfapply(e)},v.prototype.nfcall=function(){var t=J(arguments),e=p();return t.push(e.makeNodeResolver()),this.fapply(t).fail(e.reject),e.promise},l.nfbind=l.denodeify=function(t){var e=J(arguments,1);return function(){var n=e.concat(J(arguments)),r=p();return n.push(r.makeNodeResolver()),l(t).fapply(n).fail(r.reject),r.promise}},v.prototype.nfbind=v.prototype.denodeify=function(){var t=J(arguments);return t.unshift(this),l.denodeify.apply(void 0,t)},l.nbind=function(t,e){var n=J(arguments,2);return function(){function r(){return t.apply(e,arguments)}var o=n.concat(J(arguments)),i=p();return o.push(i.makeNodeResolver()),l(r).fapply(o).fail(i.reject),i.promise}},v.prototype.nbind=function(){var t=J(arguments,0);return t.unshift(this),l.nbind.apply(void 0,t)},l.nmapply=l.npost=function(t,e,n){return l(t).npost(e,n)},v.prototype.nmapply=v.prototype.npost=function(t,e){var n=J(e||[]),r=p();return n.push(r.makeNodeResolver()),this.dispatch("post",[t,n]).fail(r.reject),r.promise},l.nsend=l.nmcall=l.ninvoke=function(t,e){var n=J(arguments,2),r=p();return n.push(r.makeNodeResolver()),l(t).dispatch("post",[e,n]).fail(r.reject),r.promise},v.prototype.nsend=v.prototype.nmcall=v.prototype.ninvoke=function(t){var e=J(arguments,1),n=p();return e.push(n.makeNodeResolver()),this.dispatch("post",[t,e]).fail(n.reject),n.promise},l.nodeify=M,v.prototype.nodeify=function(t){return t?void this.then(function(e){l.nextTick(function(){t(null,e)})},function(e){l.nextTick(function(){t(e)})}):this},l.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var ct=c();return l})}).call(this,e("_process"))},{_process:2}],2:[function(t,e,n){function r(){f=!1,s.length?c=s.concat(c):l=-1,c.length&&o()}function o(){if(!f){var t=setTimeout(r);f=!0;for(var e=c.length;e;){for(s=c,c=[];++l<e;)s&&s[l].run();l=-1,e=c.length}s=null,f=!1,clearTimeout(t)}}function i(t,e){this.fun=t,this.array=e}function u(){}var s,a=e.exports={},c=[],f=!1,l=-1;a.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new i(t,e)),1!==c.length||f||setTimeout(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=u,a.addListener=u,a.once=u,a.off=u,a.removeListener=u,a.removeAllListeners=u,a.emit=u,a.binding=function(t){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],3:[function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,n,i){e=e||"&",n=n||"=";var u={};if("string"!=typeof t||0===t.length)return u;var s=/\+/g;t=t.split(e);var a=1e3;i&&"number"==typeof i.maxKeys&&(a=i.maxKeys);var c=t.length;a>0&&c>a&&(c=a);for(var f=0;c>f;++f){var l,p,d,h,v=t[f].replace(s,"%20"),y=v.indexOf(n);y>=0?(l=v.substr(0,y),p=v.substr(y+1)):(l=v,p=""),d=decodeURIComponent(l),h=decodeURIComponent(p),r(u,d)?o(u[d])?u[d].push(h):u[d]=[u[d],h]:u[d]=h}return u};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],4:[function(t,e,n){"use strict";function r(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var o=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,n,s){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?r(u(t),function(u){var s=encodeURIComponent(o(u))+n;return i(t[u])?r(t[u],function(t){return s+encodeURIComponent(o(t))}).join(e):s+encodeURIComponent(o(t[u]))}).join(e):s?encodeURIComponent(o(s))+n+encodeURIComponent(o(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},u=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},{}],5:[function(t,e,n){"use strict";n.decode=n.parse=t("./decode"),n.encode=n.stringify=t("./encode")},{"./decode":3,"./encode":4}],6:[function(t,e,n){(function(t){function n(t){if(!(this instanceof n))return new n(t);if(t&&(t instanceof n||"ObjectID"===t._bsontype))return t;var e;if(f(t)||Array.isArray(t)&&12===t.length)e=Array.prototype.slice.call(t);else if("string"==typeof t){if(12!==t.length&&!n.isValid(t))throw new Error("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");e=u(t)}else/number|undefined/.test(typeof t)&&(e=u(o(t)));Object.defineProperty(this,"id",{enumerable:!0,get:function(){return String.fromCharCode.apply(this,e)}}),Object.defineProperty(this,"str",{get:function(){return e.map(i.bind(this,2)).join("")}})}function r(){return a=(a+1)%16777215}function o(t){return"number"!=typeof t&&(t=Date.now()/1e3),t=parseInt(t,10)%4294967295,i(8,t)+i(6,s)+i(4,c)+i(6,r())}function i(t,e){return e=e.toString(16),e.length===t?e:"00000000".substring(e.length,t)+e}function u(t){var e=0,n=[];if(24===t.length)for(;24>e;n.push(parseInt(t[e]+t[e+1],16)),e+=2);else if(12===t.length)for(;12>e;n.push(t.charCodeAt(e)),e++);return n}var s=parseInt(16777215*Math.random(),10),a=n.index=parseInt(16777215*Math.random(),10),c="undefined"==typeof t||("number"!=typeof t.pid?Math.floor(1e5*Math.random()):t.pid)%65535,f=function(t){return!(null==t||!t.constructor||"function"!=typeof t.constructor.isBuffer||!t.constructor.isBuffer(t))};e.exports=n,n.generate=o,n.createFromTime=function(t){return t=parseInt(t,10)%4294967295,new n(i(8,t)+"0000000000000000")},n.createFromHexString=function(t){if(!n.isValid(t))throw new Error("Invalid ObjectID hex string");return new n(t)},n.isValid=function(t){return t?/^[0-9A-F]{24}$/i.test(t.toString()):!1},n.prototype={_bsontype:"ObjectID",toHexString:function(){return this.str},equals:function(t){return!!t&&this.str===t.toString()},getTimestamp:function(){return new Date(1e3*parseInt(this.str.substr(0,8),16))}},n.prototype.inspect=function(){return"ObjectID("+this+")"},n.prototype.toJSON=n.prototype.toHexString,n.prototype.toString=n.prototype.toHexString}).call(this,t("_process"))},{_process:2}],7:[function(t,e,n){"use strict";function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(){}var i="function"!=typeof Object.create?"~":!1;o.prototype._events=void 0,o.prototype.listeners=function(t,e){var n=i?i+t:t,r=this._events&&this._events[n];if(e)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var o=0,u=r.length,s=new Array(u);u>o;o++)s[o]=r[o].fn;return s},o.prototype.emit=function(t,e,n,r,o,u){var s=i?i+t:t;if(!this._events||!this._events[s])return!1;var a,c,f=this._events[s],l=arguments.length;if("function"==typeof f.fn){switch(f.once&&this.removeListener(t,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,e),!0;case 3:return f.fn.call(f.context,e,n),!0;case 4:return f.fn.call(f.context,e,n,r),!0;case 5:return f.fn.call(f.context,e,n,r,o),!0;case 6:return f.fn.call(f.context,e,n,r,o,u),!0}for(c=1,a=new Array(l-1);l>c;c++)a[c-1]=arguments[c];f.fn.apply(f.context,a)}else{var p,d=f.length;for(c=0;d>c;c++)switch(f[c].once&&this.removeListener(t,f[c].fn,void 0,!0),l){case 1:f[c].fn.call(f[c].context);break;case 2:f[c].fn.call(f[c].context,e);break;case 3:f[c].fn.call(f[c].context,e,n);break;default:if(!a)for(p=1,a=new Array(l-1);l>p;p++)a[p-1]=arguments[p];f[c].fn.apply(f[c].context,a)}}return!0},o.prototype.on=function(t,e,n){var o=new r(e,n||this),u=i?i+t:t;return this._events||(this._events=i?{}:Object.create(null)),this._events[u]?this._events[u].fn?this._events[u]=[this._events[u],o]:this._events[u].push(o):this._events[u]=o,this},o.prototype.once=function(t,e,n){var o=new r(e,n||this,!0),u=i?i+t:t;return this._events||(this._events=i?{}:Object.create(null)),this._events[u]?this._events[u].fn?this._events[u]=[this._events[u],o]:this._events[u].push(o):this._events[u]=o,this},o.prototype.removeListener=function(t,e,n,r){var o=i?i+t:t;if(!this._events||!this._events[o])return this;var u=this._events[o],s=[];if(e)if(u.fn)(u.fn!==e||r&&!u.once||n&&u.context!==n)&&s.push(u);else for(var a=0,c=u.length;c>a;a++)(u[a].fn!==e||r&&!u[a].once||n&&u[a].context!==n)&&s.push(u[a]);return s.length?this._events[o]=1===s.length?s[0]:s:delete this._events[o],this},o.prototype.removeAllListeners=function(t){return this._events?(t?delete this._events[i?i+t:t]:this._events=i?{}:Object.create(null),this):this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prototype.setMaxListeners=function(){return this},o.prefixed=i,"undefined"!=typeof e&&(e.exports=o)},{}],8:[function(e,n,r){(function(e,o){!function(){var t,n,r,i;!function(){var e={},o={};t=function(t,n,r){e[t]={deps:n,callback:r}},i=r=n=function(t){function r(e){if("."!==e.charAt(0))return e;for(var n=e.split("/"),r=t.split("/").slice(0,-1),o=0,i=n.length;i>o;o++){var u=n[o];if(".."===u)r.pop();else{if("."===u)continue;r.push(u)}}return r.join("/")}if(i._eak_seen=e,o[t])return o[t];if(o[t]={},!e[t])throw new Error("Could not find module "+t);for(var u,s=e[t],a=s.deps,c=s.callback,f=[],l=0,p=a.length;p>l;l++)"exports"===a[l]?f.push(u={}):f.push(n(r(a[l])));var d=c.apply(this,f);return o[t]=u||d}}(),t("promise/all",["./utils","exports"],function(t,e){"use strict";function n(t){var e=this;if(!r(t))throw new TypeError("You must pass an array to all.");return new e(function(e,n){function r(t){return function(e){i(t,e)}}function i(t,n){s[t]=n,0===--a&&e(s)}var u,s=[],a=t.length;0===a&&e([]);for(var c=0;c<t.length;c++)u=t[c],u&&o(u.then)?u.then(r(c),n):i(c,u)})}var r=t.isArray,o=t.isFunction;e.all=n}),t("promise/asap",["exports"],function(t){"use strict";function n(){return function(){e.nextTick(u)}}function r(){var t=0,e=new f(u),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function i(){return function(){l.setTimeout(u,1)}}function u(){for(var t=0;t<p.length;t++){var e=p[t],n=e[0],r=e[1];n(r)}p=[]}function s(t,e){var n=p.push([t,e]);1===n&&a()}var a,c="undefined"!=typeof window?window:{},f=c.MutationObserver||c.WebKitMutationObserver,l="undefined"!=typeof o?o:void 0===this?window:this,p=[];a="undefined"!=typeof e&&"[object process]"==={}.toString.call(e)?n():f?r():i(),t.asap=s}),t("promise/config",["exports"],function(t){"use strict";function e(t,e){return 2!==arguments.length?n[t]:void(n[t]=e)}var n={instrument:!1};t.config=n,t.configure=e}),t("promise/polyfill",["./promise","./utils","exports"],function(t,e,n){"use strict";function r(){var t;t="undefined"!=typeof o?o:"undefined"!=typeof window&&window.document?window:self;var e="Promise"in t&&"resolve"in t.Promise&&"reject"in t.Promise&&"all"in t.Promise&&"race"in t.Promise&&function(){var e;return new t.Promise(function(t){e=t}),u(e)}();e||(t.Promise=i)}var i=t.Promise,u=e.isFunction;n.polyfill=r}),t("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(t,e,n,r,o,i,u,s){"use strict";function a(t){if(!_(t))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof a))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],c(t,this)}function c(t,e){function n(t){h(e,t)}function r(t){y(e,t)}try{t(n,r)}catch(o){r(o)}}function f(t,e,n,r){var o,i,u,s,a=_(n);if(a)try{o=n(r),u=!0}catch(c){s=!0,i=c}else o=r,u=!0;d(e,o)||(a&&u?h(e,o):s?y(e,i):t===T?h(e,o):t===A&&y(e,o))}function l(t,e,n,r){var o=t._subscribers,i=o.length;o[i]=e,o[i+T]=n,o[i+A]=r}function p(t,e){for(var n,r,o=t._subscribers,i=t._detail,u=0;u<o.length;u+=3)n=o[u],r=o[u+e],f(e,n,r,i);t._subscribers=null}function d(t,e){var n,r=null;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(w(e)&&(r=e.then,_(r)))return r.call(e,function(r){return n?!0:(n=!0,void(e!==r?h(t,r):v(t,r)))},function(e){return n?!0:(n=!0,void y(t,e))}),!0}catch(o){return n?!0:(y(t,o),!0)}return!1}function h(t,e){t===e?v(t,e):d(t,e)||v(t,e)}function v(t,e){t._state===I&&(t._state=O,t._detail=e,g.async(m,t))}function y(t,e){t._state===I&&(t._state=O,t._detail=e,g.async(b,t))}function m(t){p(t,t._state=T)}function b(t){p(t,t._state=A)}var g=t.config,w=(t.configure,e.objectOrFunction),_=e.isFunction,j=(e.now,n.all),k=r.race,x=o.resolve,E=i.reject,S=u.asap;g.async=S;var I=void 0,O=0,T=1,A=2;a.prototype={constructor:a,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(t,e){var n=this,r=new this.constructor(function(){});if(this._state){var o=arguments;g.async(function(){f(n._state,r,o[n._state-1],n._detail)})}else l(this,r,t,e);return r},"catch":function(t){return this.then(null,t)}},a.all=j,a.race=k,a.resolve=x,a.reject=E,s.Promise=a}),t("promise/race",["./utils","exports"],function(t,e){"use strict";function n(t){var e=this;if(!r(t))throw new TypeError("You must pass an array to race.");return new e(function(e,n){for(var r,o=0;o<t.length;o++)r=t[o],r&&"function"==typeof r.then?r.then(e,n):e(r)})}var r=t.isArray;e.race=n}),t("promise/reject",["exports"],function(t){"use strict";function e(t){var e=this;return new e(function(e,n){n(t)})}t.reject=e}),t("promise/resolve",["exports"],function(t){"use strict";function e(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=this;return new e(function(e){e(t)})}t.resolve=e}),t("promise/utils",["exports"],function(t){"use strict";function e(t){return n(t)||"object"==typeof t&&null!==t}function n(t){return"function"==typeof t}function r(t){return"[object Array]"===Object.prototype.toString.call(t)}var o=Date.now||function(){return(new Date).getTime()};t.objectOrFunction=e,t.isFunction=n,t.isArray=r,t.now=o}),n("promise/polyfill").polyfill()}(),function(e,o){"object"==typeof r&&"object"==typeof n?n.exports=o():"function"==typeof t&&t.amd?t([],o):"object"==typeof r?r.localforage=o():e.localforage=o()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,function(){function t(t,e){t[e]=function(){var n=arguments;return t.ready().then(function(){return t[e].apply(t,n)})}}function o(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(p(e[n])?arguments[0][n]=e[n].slice():arguments[0][n]=e[n])}return arguments[0]}function i(t){for(var e in s)if(s.hasOwnProperty(e)&&s[e]===t)return!0;return!1}var u={},s={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},a=[s.INDEXEDDB,s.WEBSQL,s.LOCALSTORAGE],c=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],f={description:"",driver:a.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},l=function(t){var e=e||t.indexedDB||t.webkitIndexedDB||t.mozIndexedDB||t.OIndexedDB||t.msIndexedDB,n={};return n[s.WEBSQL]=!!t.openDatabase,n[s.INDEXEDDB]=!!function(){if("undefined"!=typeof t.openDatabase&&t.navigator&&t.navigator.userAgent&&/Safari/.test(t.navigator.userAgent)&&!/Chrome/.test(t.navigator.userAgent))return!1;try{return e&&"function"==typeof e.open&&"undefined"!=typeof t.IDBKeyRange}catch(n){return!1}}(),n[s.LOCALSTORAGE]=!!function(){try{return t.localStorage&&"setItem"in t.localStorage&&t.localStorage.setItem}catch(e){return!1}}(),n}(this),p=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},d=function(){function e(t){r(this,e),this.INDEXEDDB=s.INDEXEDDB,this.LOCALSTORAGE=s.LOCALSTORAGE,this.WEBSQL=s.WEBSQL,this._defaultConfig=o({},f),this._config=o({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)}return e.prototype.config=function(t){if("object"==typeof t){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t)"storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),this._config[e]=t[e];return"driver"in t&&t.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof t?this._config[t]:this._config},e.prototype.defineDriver=function(t,e,n){var r=new Promise(function(e,n){try{var r=t._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),s=new Error("Custom driver name already in use: "+t._driver);if(!t._driver)return void n(o);if(i(t._driver))return void n(s);for(var a=c.concat("_initStorage"),f=0;f<a.length;f++){var p=a[f];if(!p||!t[p]||"function"!=typeof t[p])return void n(o)}var d=Promise.resolve(!0);"_support"in t&&(d=t._support&&"function"==typeof t._support?t._support():Promise.resolve(!!t._support)),d.then(function(n){l[r]=n,u[r]=t,e()},n)}catch(h){n(h)}});return r.then(e,n),r},e.prototype.driver=function(){return this._driver||null;
},e.prototype.getDriver=function(t,e,r){var o=this,s=function(){if(i(t))switch(t){case o.INDEXEDDB:return new Promise(function(t,e){t(n(1))});case o.LOCALSTORAGE:return new Promise(function(t,e){t(n(2))});case o.WEBSQL:return new Promise(function(t,e){t(n(4))})}else if(u[t])return Promise.resolve(u[t]);return Promise.reject(new Error("Driver not found."))}();return s.then(e,r),s},e.prototype.getSerializer=function(t){var e=new Promise(function(t,e){t(n(3))});return t&&"function"==typeof t&&e.then(function(e){t(e)}),e},e.prototype.ready=function(t){var e=this,n=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return n.then(t,t),n},e.prototype.setDriver=function(t,e,n){function r(){i._config.driver=i.driver()}function o(t){return function(){function e(){for(;n<t.length;){var o=t[n];return n++,i._dbInfo=null,i._ready=null,i.getDriver(o).then(function(t){return i._extend(t),r(),i._ready=i._initStorage(i._config),i._ready})["catch"](e)}r();var u=new Error("No available storage method found.");return i._driverSet=Promise.reject(u),i._driverSet}var n=0;return e()}}var i=this;p(t)||(t=[t]);var u=this._getSupportedDrivers(t),s=null!==this._driverSet?this._driverSet["catch"](function(){return Promise.resolve()}):Promise.resolve();return this._driverSet=s.then(function(){var t=u[0];return i._dbInfo=null,i._ready=null,i.getDriver(t).then(function(t){i._driver=t._driver,r(),i._wrapLibraryMethodsWithReady(),i._initDriver=o(u)})})["catch"](function(){r();var t=new Error("No available storage method found.");return i._driverSet=Promise.reject(t),i._driverSet}),this._driverSet.then(e,n),this._driverSet},e.prototype.supports=function(t){return!!l[t]},e.prototype._extend=function(t){o(this,t)},e.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,r=t.length;r>n;n++){var o=t[n];this.supports(o)&&e.push(o)}return e},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0;e<c.length;e++)t(this,c[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),h=new d;e["default"]=h}.call("undefined"!=typeof window?window:self),t.exports=e["default"]},function(t,e){"use strict";e.__esModule=!0,function(){function t(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(n){if("TypeError"!==n.name)throw n;for(var r=k.BlobBuilder||k.MSBlobBuilder||k.MozBlobBuilder||k.WebKitBlobBuilder,o=new r,i=0;i<t.length;i+=1)o.append(t[i]);return o.getBlob(e.type)}}function n(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),o=0;e>o;o++)r[o]=t.charCodeAt(o);return n}function r(t){return new Promise(function(e,n){var r=new XMLHttpRequest;r.open("GET",t),r.withCredentials=!0,r.responseType="arraybuffer",r.onreadystatechange=function(){return 4===r.readyState?200===r.status?e({response:r.response,type:r.getResponseHeader("Content-Type")}):void n({status:r.status,response:r.response}):void 0},r.send()})}function o(e){return new Promise(function(n,o){var i=t([""],{type:"image/png"}),u=e.transaction([I],"readwrite");u.objectStore(I).put(i,"key"),u.oncomplete=function(){var t=e.transaction([I],"readwrite"),i=t.objectStore(I).get("key");i.onerror=o,i.onsuccess=function(t){var e=t.target.result,o=URL.createObjectURL(e);r(o).then(function(t){n(!(!t||"image/png"!==t.type))},function(){n(!1)}).then(function(){URL.revokeObjectURL(o)})}}})["catch"](function(){return!1})}function i(t){return"boolean"==typeof E?Promise.resolve(E):o(t).then(function(t){return E=t})}function u(t){return new Promise(function(e,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:t.type})},r.readAsBinaryString(t)})}function s(e){var r=n(atob(e.data));return t([r],{type:e.type})}function a(t){return t&&t.__local_forage_encoded_blob}function c(t){function e(){return Promise.resolve()}var n=this,r={db:null};if(t)for(var o in t)r[o]=t[o];S||(S={});var i=S[r.name];i||(i={forages:[],db:null},S[r.name]=i),i.forages.push(this);for(var u=[],s=0;s<i.forages.length;s++){var a=i.forages[s];a!==this&&u.push(a.ready()["catch"](e))}var c=i.forages.slice(0);return Promise.all(u).then(function(){return r.db=i.db,f(r)}).then(function(t){return r.db=t,d(r,n._defaultConfig.version)?l(r):t}).then(function(t){r.db=i.db=t,n._dbInfo=r;for(var e in c){var o=c[e];o!==n&&(o._dbInfo.db=r.db,o._dbInfo.version=r.version)}})}function f(t){return p(t,!1)}function l(t){return p(t,!0)}function p(t,e){return new Promise(function(n,r){if(t.db){if(!e)return n(t.db);t.db.close()}var o=[t.name];e&&o.push(t.version);var i=x.open.apply(x,o);e&&(i.onupgradeneeded=function(e){var n=i.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore(I)}catch(r){if("ConstraintError"!==r.name)throw r;k.console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),i.onerror=function(){r(i.error)},i.onsuccess=function(){n(i.result)}})}function d(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),r=t.version<t.db.version,o=t.version>t.db.version;if(r&&(t.version!==e&&k.console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),o||n){if(n){var i=t.db.version+1;i>t.version&&(t.version=i)}return!0}return!1}function h(t,e){var n=this;"string"!=typeof t&&(k.console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new Promise(function(e,r){n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),u=i.get(t);u.onsuccess=function(){var t=u.result;void 0===t&&(t=null),a(t)&&(t=s(t)),e(t)},u.onerror=function(){r(u.error)}})["catch"](r)});return j(r,e),r}function v(t,e){var n=this,r=new Promise(function(e,r){n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),u=i.openCursor(),c=1;u.onsuccess=function(){var n=u.result;if(n){var r=n.value;a(r)&&(r=s(r));var o=t(r,n.key,c++);void 0!==o?e(o):n["continue"]()}else e()},u.onerror=function(){r(u.error)}})["catch"](r)});return j(r,e),r}function y(t,e,n){var r=this;"string"!=typeof t&&(k.console.warn(t+" used as a key, but it is not a string."),t=String(t));var o=new Promise(function(n,o){var s;r.ready().then(function(){return s=r._dbInfo,i(s.db)}).then(function(t){return!t&&e instanceof Blob?u(e):e}).then(function(e){var r=s.db.transaction(s.storeName,"readwrite"),i=r.objectStore(s.storeName);null===e&&(e=void 0);var u=i.put(e,t);r.oncomplete=function(){void 0===e&&(e=null),n(e)},r.onabort=r.onerror=function(){var t=u.error?u.error:u.transaction.error;o(t)}})["catch"](o)});return j(o,n),o}function m(t,e){var n=this;"string"!=typeof t&&(k.console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new Promise(function(e,r){n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readwrite"),u=i.objectStore(o.storeName),s=u["delete"](t);i.oncomplete=function(){e()},i.onerror=function(){r(s.error)},i.onabort=function(){var t=s.error?s.error:s.transaction.error;r(t)}})["catch"](r)});return j(r,e),r}function b(t){var e=this,n=new Promise(function(t,n){e.ready().then(function(){var r=e._dbInfo,o=r.db.transaction(r.storeName,"readwrite"),i=o.objectStore(r.storeName),u=i.clear();o.oncomplete=function(){t()},o.onabort=o.onerror=function(){var t=u.error?u.error:u.transaction.error;n(t)}})["catch"](n)});return j(n,t),n}function g(t){var e=this,n=new Promise(function(t,n){e.ready().then(function(){var r=e._dbInfo,o=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),i=o.count();i.onsuccess=function(){t(i.result)},i.onerror=function(){n(i.error)}})["catch"](n)});return j(n,t),n}function w(t,e){var n=this,r=new Promise(function(e,r){return 0>t?void e(null):void n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),u=!1,s=i.openCursor();s.onsuccess=function(){var n=s.result;return n?void(0===t?e(n.key):u?e(n.key):(u=!0,n.advance(t))):void e(null)},s.onerror=function(){r(s.error)}})["catch"](r)});return j(r,e),r}function _(t){var e=this,n=new Promise(function(t,n){e.ready().then(function(){var r=e._dbInfo,o=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),i=o.openCursor(),u=[];i.onsuccess=function(){var e=i.result;return e?(u.push(e.key),void e["continue"]()):void t(u)},i.onerror=function(){n(i.error)}})["catch"](n)});return j(n,t),n}function j(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}var k=this,x=x||this.indexedDB||this.webkitIndexedDB||this.mozIndexedDB||this.OIndexedDB||this.msIndexedDB;if(x){var E,S,I="local-forage-detect-blob-support",O={_driver:"asyncStorage",_initStorage:c,iterate:v,getItem:h,setItem:y,removeItem:m,clear:b,length:g,key:w,keys:_};e["default"]=O}}.call("undefined"!=typeof window?window:self),t.exports=e["default"]},function(t,e,n){"use strict";e.__esModule=!0,function(){function t(t){var e=this,r={};if(t)for(var o in t)r[o]=t[o];return r.keyPrefix=r.name+"/",r.storeName!==e._defaultConfig.storeName&&(r.keyPrefix+=r.storeName+"/"),e._dbInfo=r,new Promise(function(t,e){t(n(3))}).then(function(t){return r.serializer=t,Promise.resolve()})}function r(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo.keyPrefix,n=d.length-1;n>=0;n--){var r=d.key(n);0===r.indexOf(t)&&d.removeItem(r)}});return l(n,t),n}function o(t,e){var n=this;"string"!=typeof t&&(p.console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=n.ready().then(function(){var e=n._dbInfo,r=d.getItem(e.keyPrefix+t);return r&&(r=e.serializer.deserialize(r)),r});return l(r,e),r}function i(t,e){var n=this,r=n.ready().then(function(){for(var e=n._dbInfo,r=e.keyPrefix,o=r.length,i=d.length,u=1,s=0;i>s;s++){var a=d.key(s);if(0===a.indexOf(r)){var c=d.getItem(a);if(c&&(c=e.serializer.deserialize(c)),c=t(c,a.substring(o),u++),void 0!==c)return c}}});return l(r,e),r}function u(t,e){var n=this,r=n.ready().then(function(){var e,r=n._dbInfo;try{e=d.key(t)}catch(o){e=null}return e&&(e=e.substring(r.keyPrefix.length)),e});return l(r,e),r}function s(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo,n=d.length,r=[],o=0;n>o;o++)0===d.key(o).indexOf(t.keyPrefix)&&r.push(d.key(o).substring(t.keyPrefix.length));return r});return l(n,t),n}function a(t){var e=this,n=e.keys().then(function(t){return t.length});return l(n,t),n}function c(t,e){var n=this;"string"!=typeof t&&(p.console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=n.ready().then(function(){var e=n._dbInfo;d.removeItem(e.keyPrefix+t)});return l(r,e),r}function f(t,e,n){var r=this;"string"!=typeof t&&(p.console.warn(t+" used as a key, but it is not a string."),t=String(t));var o=r.ready().then(function(){void 0===e&&(e=null);var n=e;return new Promise(function(o,i){var u=r._dbInfo;u.serializer.serialize(e,function(e,r){if(r)i(r);else try{d.setItem(u.keyPrefix+t,e),o(n)}catch(s){("QuotaExceededError"===s.name||"NS_ERROR_DOM_QUOTA_REACHED"===s.name)&&i(s),i(s)}})})});return l(o,n),o}function l(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}var p=this,d=null;try{if(!(this.localStorage&&"setItem"in this.localStorage))return;d=this.localStorage}catch(h){return}var v={_driver:"localStorageWrapper",_initStorage:t,iterate:i,getItem:o,setItem:f,removeItem:c,clear:r,length:a,key:u,keys:s};e["default"]=v}.call("undefined"!=typeof window?window:self),t.exports=e["default"]},function(t,e){"use strict";e.__esModule=!0,function(){function t(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(n){if("TypeError"!==n.name)throw n;for(var r=k.BlobBuilder||k.MSBlobBuilder||k.MozBlobBuilder||k.WebKitBlobBuilder,o=new r,i=0;i<t.length;i+=1)o.append(t[i]);return o.getBlob(e.type)}}function n(t,e){var n="";if(t&&(n=t.toString()),t&&("[object ArrayBuffer]"===t.toString()||t.buffer&&"[object ArrayBuffer]"===t.buffer.toString())){var r,o=c;t instanceof ArrayBuffer?(r=t,o+=l):(r=t.buffer,"[object Int8Array]"===n?o+=d:"[object Uint8Array]"===n?o+=h:"[object Uint8ClampedArray]"===n?o+=v:"[object Int16Array]"===n?o+=y:"[object Uint16Array]"===n?o+=b:"[object Int32Array]"===n?o+=m:"[object Uint32Array]"===n?o+=g:"[object Float32Array]"===n?o+=w:"[object Float64Array]"===n?o+=_:e(new Error("Failed to get type for BinaryArray"))),e(o+i(r))}else if("[object Blob]"===n){var u=new FileReader;u.onload=function(){var n=s+t.type+"~"+i(this.result);e(c+p+n)},u.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(a){console.error("Couldn't convert value into a JSON string: ",t),e(null,a)}}function r(e){if(e.substring(0,f)!==c)return JSON.parse(e);var n,r=e.substring(j),i=e.substring(f,j);if(i===p&&a.test(r)){var u=r.match(a);n=u[1],r=r.substring(u[0].length)}var s=o(r);switch(i){case l:return s;case p:return t([s],{type:n});case d:return new Int8Array(s);case h:return new Uint8Array(s);case v:return new Uint8ClampedArray(s);case y:return new Int16Array(s);case b:return new Uint16Array(s);case m:return new Int32Array(s);case g:return new Uint32Array(s);case w:return new Float32Array(s);case _:return new Float64Array(s);default:throw new Error("Unkown type: "+i)}}function o(t){var e,n,r,o,i,s=.75*t.length,a=t.length,c=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var f=new ArrayBuffer(s),l=new Uint8Array(f);for(e=0;a>e;e+=4)n=u.indexOf(t[e]),r=u.indexOf(t[e+1]),o=u.indexOf(t[e+2]),i=u.indexOf(t[e+3]),l[c++]=n<<2|r>>4,l[c++]=(15&r)<<4|o>>2,l[c++]=(3&o)<<6|63&i;return f}function i(t){var e,n=new Uint8Array(t),r="";for(e=0;e<n.length;e+=3)r+=u[n[e]>>2],r+=u[(3&n[e])<<4|n[e+1]>>4],r+=u[(15&n[e+1])<<2|n[e+2]>>6],r+=u[63&n[e+2]];return n.length%3===2?r=r.substring(0,r.length-1)+"=":n.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s="~~local_forage_type~",a=/^~~local_forage_type~([^~]+)~/,c="__lfsc__:",f=c.length,l="arbf",p="blob",d="si08",h="ui08",v="uic8",y="si16",m="si32",b="ur16",g="ui32",w="fl32",_="fl64",j=f+l.length,k=this,x={serialize:n,deserialize:r,stringToBuffer:o,bufferToString:i};e["default"]=x}.call("undefined"!=typeof window?window:self),t.exports=e["default"]},function(t,e,n){"use strict";e.__esModule=!0,function(){function t(t){var e=this,r={db:null};if(t)for(var o in t)r[o]="string"!=typeof t[o]?t[o].toString():t[o];var i=new Promise(function(n,o){try{r.db=d(r.name,String(r.version),r.description,r.size)}catch(i){return e.setDriver(e.LOCALSTORAGE).then(function(){return e._initStorage(t)}).then(n)["catch"](o)}r.db.transaction(function(t){t.executeSql("CREATE TABLE IF NOT EXISTS "+r.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){e._dbInfo=r,n()},function(t,e){o(e)})})});return new Promise(function(t,e){t(n(3))}).then(function(t){return r.serializer=t,i})}function r(t,e){var n=this;"string"!=typeof t&&(p.console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new Promise(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[t],function(t,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),e(r)},function(t,e){r(e)})})})["catch"](r)});return l(r,e),r}function o(t,e){var n=this,r=new Promise(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT * FROM "+o.storeName,[],function(n,r){for(var i=r.rows,u=i.length,s=0;u>s;s++){var a=i.item(s),c=a.value;if(c&&(c=o.serializer.deserialize(c)),c=t(c,a.key,s+1),void 0!==c)return void e(c)}e()},function(t,e){r(e)})})})["catch"](r)});return l(r,e),r}function i(t,e,n){var r=this;"string"!=typeof t&&(p.console.warn(t+" used as a key, but it is not a string."),t=String(t));var o=new Promise(function(n,o){r.ready().then(function(){void 0===e&&(e=null);var i=e,u=r._dbInfo;u.serializer.serialize(e,function(e,r){r?o(r):u.db.transaction(function(r){r.executeSql("INSERT OR REPLACE INTO "+u.storeName+" (key, value) VALUES (?, ?)",[t,e],function(){n(i)},function(t,e){o(e)})},function(t){t.code===t.QUOTA_ERR&&o(t)})})})["catch"](o)});return l(o,n),o}function u(t,e){var n=this;"string"!=typeof t&&(p.console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new Promise(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("DELETE FROM "+o.storeName+" WHERE key = ?",[t],function(){e()},function(t,e){r(e)})})})["catch"](r)});return l(r,e),r}function s(t){var e=this,n=new Promise(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){e.executeSql("DELETE FROM "+r.storeName,[],function(){t()},function(t,e){n(e)})})})["catch"](n)});return l(n,t),n}function a(t){var e=this,n=new Promise(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){e.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],function(e,n){var r=n.rows.item(0).c;t(r)},function(t,e){n(e)})})})["catch"](n)});return l(n,t),n}function c(t,e){var n=this,r=new Promise(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,n){var r=n.rows.length?n.rows.item(0).key:null;e(r)},function(t,e){r(e)})})})["catch"](r)});return l(r,e),r}function f(t){var e=this,n=new Promise(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){e.executeSql("SELECT key FROM "+r.storeName,[],function(e,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);t(r)},function(t,e){n(e)})})})["catch"](n)});return l(n,t),n}function l(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}var p=this,d=this.openDatabase;if(d){var h={_driver:"webSQLStorage",_initStorage:t,iterate:o,getItem:r,setItem:i,removeItem:u,clear:s,length:a,key:c,keys:f};e["default"]=h}}.call("undefined"!=typeof window?window:self),t.exports=e["default"]}])})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:2}],9:[function(t,e,n){function r(t,e,n){var r=null==t?void 0:o(t,i(e),e+"");return void 0===r?n:r}var o=t("lodash._baseget"),i=t("lodash._topath");e.exports=r},{"lodash._baseget":10,"lodash._topath":11}],10:[function(t,e,n){function r(t,e,n){if(null!=t){void 0!==n&&n in o(t)&&(e=[n]);for(var r=0,i=e.length;null!=t&&i>r;)t=t[e[r++]];return r&&r==i?t:void 0}}function o(t){return i(t)?t:Object(t)}function i(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}e.exports=r},{}],11:[function(t,e,n){function r(t){return null==t?"":t+""}function o(t){if(i(t))return t;var e=[];return r(t).replace(u,function(t,n,r,o){e.push(r?o.replace(s,"$1"):n||t)}),e}var i=t("lodash.isarray"),u=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,s=/\\(\\)?/g;e.exports=o},{"lodash.isarray":12}],12:[function(t,e,n){function r(t){return!!t&&"object"==typeof t}function o(t,e){var n=null==t?void 0:t[e];return a(n)?n:void 0}function i(t){return"number"==typeof t&&t>-1&&t%1==0&&b>=t}function u(t){return s(t)&&v.call(t)==f}function s(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function a(t){return null==t?!1:u(t)?y.test(d.call(t)):r(t)&&l.test(t)}var c="[object Array]",f="[object Function]",l=/^\[object .+?Constructor\]$/,p=Object.prototype,d=Function.prototype.toString,h=p.hasOwnProperty,v=p.toString,y=RegExp("^"+d.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),m=o(Array,"isArray"),b=9007199254740991,g=m||function(t){return r(t)&&i(t.length)&&v.call(t)==c};e.exports=g},{}],13:[function(t,e,n){function r(t,e,n,r){return null==t?[]:(r&&i(e,n,r)&&(n=void 0),u(e)||(e=null==e?[]:[e]),u(n)||(n=null==n?[]:[n]),o(t,e,n))}var o=t("lodash._basesortbyorder"),i=t("lodash._isiterateecall"),u=t("lodash.isarray");e.exports=r},{"lodash._basesortbyorder":18,"lodash._isiterateecall":33,"lodash.isarray":34}],14:[function(t,e,n){function r(t,e){return d(t,e,f)}function o(t){return function(e){return null==e?void 0:e[t]}}function i(t,e){return function(n,r){var o=n?h(n):0;if(!s(o))return t(n,r);for(var i=e?o:-1,u=a(n);(e?i--:++i<o)&&r(u[i],i,u)!==!1;);return n}}function u(t){return function(e,n,r){for(var o=a(e),i=r(e),u=i.length,s=t?u:-1;t?s--:++s<u;){var c=i[s];if(n(o[c],c,o)===!1)break}return e}}function s(t){return"number"==typeof t&&t>-1&&t%1==0&&l>=t}function a(t){return c(t)?t:Object(t)}function c(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var f=t("lodash.keys"),l=9007199254740991,p=i(r),d=u(),h=o("length");e.exports=p},{"lodash.keys":15}],15:[function(t,e,n){function r(t){return function(e){return null==e?void 0:e[t]}}function o(t){return null!=t&&u(b(t))}function i(t,e){return t="number"==typeof t||d.test(t)?+t:-1,e=null==e?m:e,t>-1&&t%1==0&&e>t}function u(t){return"number"==typeof t&&t>-1&&t%1==0&&m>=t}function s(t){for(var e=c(t),n=e.length,r=n&&t.length,o=!!r&&u(r)&&(p(t)||l(t)),s=-1,a=[];++s<n;){var f=e[s];(o&&i(f,r)||v.call(t,f))&&a.push(f)}return a}function a(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function c(t){if(null==t)return[];a(t)||(t=Object(t));var e=t.length;e=e&&u(e)&&(p(t)||l(t))&&e||0;for(var n=t.constructor,r=-1,o="function"==typeof n&&n.prototype===t,s=Array(e),c=e>0;++r<e;)s[r]=r+"";for(var f in t)c&&i(f,e)||"constructor"==f&&(o||!v.call(t,f))||s.push(f);return s}var f=t("lodash._getnative"),l=t("lodash.isarguments"),p=t("lodash.isarray"),d=/^\d+$/,h=Object.prototype,v=h.hasOwnProperty,y=f(Object,"keys"),m=9007199254740991,b=r("length"),g=y?function(t){var e=null==t?void 0:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&o(t)?s(t):a(t)?y(t):[]}:s;e.exports=g},{"lodash._getnative":16,"lodash.isarguments":17,"lodash.isarray":34}],16:[function(t,e,n){function r(t){return!!t&&"object"==typeof t}function o(t,e){var n=null==t?void 0:t[e];return s(n)?n:void 0}function i(t){return u(t)&&d.call(t)==a}function u(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function s(t){return null==t?!1:i(t)?h.test(l.call(t)):r(t)&&c.test(t)}var a="[object Function]",c=/^\[object .+?Constructor\]$/,f=Object.prototype,l=Function.prototype.toString,p=f.hasOwnProperty,d=f.toString,h=RegExp("^"+l.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=o},{}],17:[function(t,e,n){function r(t){return!!t&&"object"==typeof t}function o(t){return function(e){return null==e?void 0:e[t]}}function i(t){return null!=t&&u(p(t))}function u(t){return"number"==typeof t&&t>-1&&t%1==0&&l>=t}function s(t){return r(t)&&i(t)&&c.call(t,"callee")&&!f.call(t,"callee")}var a=Object.prototype,c=a.hasOwnProperty,f=a.propertyIsEnumerable,l=9007199254740991,p=o("length");e.exports=s},{}],18:[function(t,e,n){function r(t,e,n){for(var r=-1,o=t.criteria,i=e.criteria,u=o.length,s=n.length;++r<u;){var a=l(o[r],i[r]);if(a){if(r>=s)return a;var c=n[r];return a*("asc"===c||c===!0?1:-1)}}return t.index-e.index}function o(t,e){var n=-1,r=s(t)?Array(t.length):[];return p(t,function(t,o,i){r[++n]=e(t,o,i)}),r}function i(t){return function(e){return null==e?void 0:e[t]}}function u(t,e,n){var i=-1;e=c(e,function(t){return f(t)});var u=o(t,function(t){var n=c(e,function(e){return e(t)});return{criteria:n,index:++i,value:t}});return d(u,function(t,e){return r(t,e,n)})}function s(t){return null!=t&&a(v(t))}function a(t){return"number"==typeof t&&t>-1&&t%1==0&&h>=t}var c=t("lodash._arraymap"),f=t("lodash._basecallback"),l=t("lodash._basecompareascending"),p=t("lodash._baseeach"),d=t("lodash._basesortby"),h=9007199254740991,v=i("length");e.exports=u},{"lodash._arraymap":19,"lodash._basecallback":20,"lodash._basecompareascending":31,"lodash._baseeach":14,"lodash._basesortby":32}],19:[function(t,e,n){function r(t,e){for(var n=-1,r=t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}e.exports=r},{}],20:[function(t,e,n){function r(t){return null==t?"":t+""}function o(t,e,n){var r=typeof t;return"function"==r?void 0===e?t:j(t,e,n):null==t?g:"object"==r?s(t):void 0===e?w(t):a(t,e)}function i(t,e,n){if(null!=t){void 0!==n&&n in v(t)&&(e=[n]);for(var r=0,o=e.length;null!=t&&o>r;)t=t[e[r++]];return r&&r==o?t:void 0}}function u(t,e,n){var r=e.length,o=r,i=!n;if(null==t)return!o;for(t=v(t);r--;){var u=e[r];if(i&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++r<o;){u=e[r];var s=u[0],a=t[s],c=u[1];if(i&&u[2]){if(void 0===a&&!(s in t))return!1}else{var f=n?n(a,c,s):void 0;if(!(void 0===f?_(c,a,n,!0):f))return!1}}return!0}function s(t){var e=p(t);if(1==e.length&&e[0][2]){var n=e[0][0],r=e[0][1];return function(t){return null==t?!1:t[n]===r&&(void 0!==r||n in v(t))}}return function(t){return u(t,e)}}function a(t,e){var n=k(t),r=d(t)&&h(e),o=t+"";return t=y(t),function(u){if(null==u)return!1;var s=o;if(u=v(u),(n||!r)&&!(s in u)){if(u=1==t.length?u:i(u,l(t,0,-1)),null==u)return!1;s=m(t),u=v(u)}return u[s]===e?void 0!==e||s in u:_(e,u[s],void 0,!0)}}function c(t){return function(e){return null==e?void 0:e[t]}}function f(t){var e=t+"";return t=y(t),function(n){return i(n,t,e)}}function l(t,e,n){var r=-1,o=t.length;e=null==e?0:+e||0,0>e&&(e=-e>o?0:o+e),n=void 0===n||n>o?o:+n||0,0>n&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var i=Array(o);++r<o;)i[r]=t[r+e];return i}function p(t){for(var e=x(t),n=e.length;n--;)e[n][2]=h(e[n][1]);return e}function d(t,e){var n=typeof t;if("string"==n&&S.test(t)||"number"==n)return!0;if(k(t))return!1;var r=!E.test(t);return r||null!=e&&t in v(e)}function h(t){return t===t&&!b(t)}function v(t){return b(t)?t:Object(t)}function y(t){if(k(t))return t;var e=[];return r(t).replace(I,function(t,n,r,o){e.push(r?o.replace(O,"$1"):n||t)}),e}function m(t){var e=t?t.length:0;return e?t[e-1]:void 0}function b(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){return t}function w(t){return d(t)?c(t):f(t)}var _=t("lodash._baseisequal"),j=t("lodash._bindcallback"),k=t("lodash.isarray"),x=t("lodash.pairs"),E=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,S=/^\w*$/,I=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,O=/\\(\\)?/g;e.exports=o},{"lodash._baseisequal":21,"lodash._bindcallback":26,"lodash.isarray":34,"lodash.pairs":27}],21:[function(t,e,n){function r(t){return!!t&&"object"==typeof t}function o(t,e){for(var n=-1,r=t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function i(t,e,n,o,s,a){return t===e?!0:null==t||null==e||!f(t)&&!r(e)?t!==t&&e!==e:u(t,e,i,n,o,s,a)}function u(t,e,n,r,o,i,u){var f=l(t),d=l(e),y=v,m=v;f||(y=E.call(t),y==h?y=w:y!=w&&(f=p(t))),d||(m=E.call(e),m==h?m=w:m!=w&&(d=p(e)));var b=y==w,g=m==w,_=y==m;if(_&&!f&&!b)return a(t,e,y);if(!o){var j=b&&x.call(t,"__wrapped__"),k=g&&x.call(e,"__wrapped__");if(j||k)return n(j?t.value():t,k?e.value():e,r,o,i,u)}if(!_)return!1;i||(i=[]),u||(u=[]);for(var S=i.length;S--;)if(i[S]==t)return u[S]==e;i.push(t),u.push(e);var I=(f?s:c)(t,e,n,r,o,i,u);return i.pop(),u.pop(),I}function s(t,e,n,r,i,u,s){var a=-1,c=t.length,f=e.length;if(c!=f&&!(i&&f>c))return!1;for(;++a<c;){var l=t[a],p=e[a],d=r?r(i?p:l,i?l:p,a):void 0;if(void 0!==d){if(d)continue;return!1}if(i){if(!o(e,function(t){return l===t||n(l,t,r,i,u,s)}))return!1}else if(l!==p&&!n(l,p,r,i,u,s))return!1}return!0}function a(t,e,n){switch(n){case y:case m:return+t==+e;case b:return t.name==e.name&&t.message==e.message;case g:return t!=+t?e!=+e:t==+e;case _:case j:return t==e+""}return!1}function c(t,e,n,r,o,i,u){var s=d(t),a=s.length,c=d(e),f=c.length;if(a!=f&&!o)return!1;for(var l=a;l--;){var p=s[l];if(!(o?p in e:x.call(e,p)))return!1}for(var h=o;++l<a;){p=s[l];var v=t[p],y=e[p],m=r?r(o?y:v,o?v:y,p):void 0;if(!(void 0===m?n(v,y,r,o,i,u):m))return!1;h||(h="constructor"==p)}if(!h){var b=t.constructor,g=e.constructor;if(b!=g&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof g&&g instanceof g))return!1}return!0}function f(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var l=t("lodash.isarray"),p=t("lodash.istypedarray"),d=t("lodash.keys"),h="[object Arguments]",v="[object Array]",y="[object Boolean]",m="[object Date]",b="[object Error]",g="[object Number]",w="[object Object]",_="[object RegExp]",j="[object String]",k=Object.prototype,x=k.hasOwnProperty,E=k.toString;e.exports=i},{"lodash.isarray":34,"lodash.istypedarray":22,"lodash.keys":23}],22:[function(t,e,n){function r(t){return!!t&&"object"==typeof t}function o(t){return"number"==typeof t&&t>-1&&t%1==0&&D>=t}function i(t){return r(t)&&o(t.length)&&!!T[P.call(t)]}var u="[object Arguments]",s="[object Array]",a="[object Boolean]",c="[object Date]",f="[object Error]",l="[object Function]",p="[object Map]",d="[object Number]",h="[object Object]",v="[object RegExp]",y="[object Set]",m="[object String]",b="[object WeakMap]",g="[object ArrayBuffer]",w="[object Float32Array]",_="[object Float64Array]",j="[object Int8Array]",k="[object Int16Array]",x="[object Int32Array]",E="[object Uint8Array]",S="[object Uint8ClampedArray]",I="[object Uint16Array]",O="[object Uint32Array]",T={};T[w]=T[_]=T[j]=T[k]=T[x]=T[E]=T[S]=T[I]=T[O]=!0,T[u]=T[s]=T[g]=T[a]=T[c]=T[f]=T[l]=T[p]=T[d]=T[h]=T[v]=T[y]=T[m]=T[b]=!1;var A=Object.prototype,P=A.toString,D=9007199254740991;e.exports=i},{}],23:[function(t,e,n){arguments[4][15][0].apply(n,arguments)},{dup:15,"lodash._getnative":24,"lodash.isarguments":25,"lodash.isarray":34}],24:[function(t,e,n){arguments[4][16][0].apply(n,arguments)},{dup:16}],25:[function(t,e,n){arguments[4][17][0].apply(n,arguments)},{dup:17}],26:[function(t,e,n){function r(t,e,n){if("function"!=typeof t)return o;if(void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,o){return t.call(e,n,r,o)};case 4:return function(n,r,o,i){return t.call(e,n,r,o,i)};case 5:return function(n,r,o,i,u){return t.call(e,n,r,o,i,u)}}return function(){return t.apply(e,arguments)}}function o(t){return t}e.exports=r},{}],27:[function(t,e,n){function r(t){return o(t)?t:Object(t)}function o(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function i(t){t=r(t);for(var e=-1,n=u(t),o=n.length,i=Array(o);++e<o;){var s=n[e];i[e]=[s,t[s]]}return i}var u=t("lodash.keys");e.exports=i},{"lodash.keys":28}],28:[function(t,e,n){arguments[4][15][0].apply(n,arguments)},{dup:15,"lodash._getnative":29,"lodash.isarguments":30,"lodash.isarray":34}],29:[function(t,e,n){arguments[4][16][0].apply(n,arguments)},{dup:16}],30:[function(t,e,n){arguments[4][17][0].apply(n,arguments)},{dup:17}],31:[function(t,e,n){function r(t,e){if(t!==e){var n=null===t,r=void 0===t,o=t===t,i=null===e,u=void 0===e,s=e===e;if(t>e&&!i||!o||n&&!u&&s||r&&s)return 1;if(e>t&&!n||!s||i&&!r&&o||u&&o)return-1}return 0}e.exports=r},{}],32:[function(t,e,n){function r(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}e.exports=r},{}],33:[function(t,e,n){function r(t){return function(e){return null==e?void 0:e[t]}}function o(t){return null!=t&&s(l(t))}function i(t,e){return t="number"==typeof t||c.test(t)?+t:-1,e=null==e?f:e,t>-1&&t%1==0&&e>t}function u(t,e,n){if(!a(n))return!1;var r=typeof e;if("number"==r?o(n)&&i(e,n.length):"string"==r&&e in n){var u=n[e];return t===t?t===u:u!==u}return!1}function s(t){return"number"==typeof t&&t>-1&&t%1==0&&f>=t}function a(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var c=/^\d+$/,f=9007199254740991,l=r("length");e.exports=u},{}],34:[function(t,e,n){arguments[4][12][0].apply(n,arguments)},{dup:12}],35:[function(t,e,n){e.exports=function(t){if(!t||"object"!=typeof t)return t;var e;if(o(t)){var n=t.length;e=Array(n);for(var i=0;n>i;i++)e[i]=t[i]}else{var u=r(t);e={};for(var i=0,s=u.length;s>i;i++){var a=u[i];e[a]=t[a]}}return e};var r=Object.keys||function(t){var e=[];for(var n in t)({}).hasOwnProperty.call(t,n)&&e.push(n);return e},o=Array.isArray||function(t){return"[object Array]"==={}.toString.call(t)}},{}],36:[function(t,e,n){!function(){
"use strict";function t(t){if("string"!=typeof t&&(t=t.toString()),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function e(t){return"string"!=typeof t&&(t=t.toString()),t}function n(t){this.map={},t instanceof n?t.forEach(function(t,e){this.append(e,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function r(t){return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function o(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function i(t){var e=new FileReader;return e.readAsArrayBuffer(t),o(e)}function u(t){var e=new FileReader;return e.readAsText(t),o(e)}function s(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,"string"==typeof t)this._bodyText=t;else if(d.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(d.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else{if(t)throw new Error("unsupported BodyInit type");this._bodyText=""}},d.blob?(this.blob=function(){var t=r(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(i)},this.text=function(){var t=r(this);if(t)return t;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var t=r(this);return t?t:Promise.resolve(this._bodyText)},d.formData&&(this.formData=function(){return this.text().then(f)}),this.json=function(){return this.text().then(JSON.parse)},this}function a(t){var e=t.toUpperCase();return h.indexOf(e)>-1?e:t}function c(t,e){if(e=e||{},this.url=t,this.credentials=e.credentials||"omit",this.headers=new n(e.headers),this.method=a(e.method||"GET"),this.mode=e.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&e.body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(e.body)}function f(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(o))}}),e}function l(t){var e=new n,r=t.getAllResponseHeaders().trim().split("\n");return r.forEach(function(t){var n=t.trim().split(":"),r=n.shift().trim(),o=n.join(":").trim();e.append(r,o)}),e}function p(t,e){e||(e={}),this._initBody(t),this.type="default",this.url=null,this.status=e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof n?e.headers:new n(e.headers),this.url=e.url||""}if(!self.fetch){n.prototype.append=function(n,r){n=t(n),r=e(r);var o=this.map[n];o||(o=[],this.map[n]=o),o.push(r)},n.prototype["delete"]=function(e){delete this.map[t(e)]},n.prototype.get=function(e){var n=this.map[t(e)];return n?n[0]:null},n.prototype.getAll=function(e){return this.map[t(e)]||[]},n.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},n.prototype.set=function(n,r){this.map[t(n)]=[e(r)]},n.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach(function(n){this.map[n].forEach(function(r){t.call(e,r,n,this)},this)},this)};var d={blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in self},h=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];s.call(c.prototype),s.call(p.prototype),self.Headers=n,self.Request=c,self.Response=p,self.fetch=function(t,e){var n;return n=c.prototype.isPrototypeOf(t)&&!e?t:new c(t,e),new Promise(function(t,e){function r(){return"responseURL"in o?o.responseURL:/^X-Request-URL:/m.test(o.getAllResponseHeaders())?o.getResponseHeader("X-Request-URL"):void 0}var o=new XMLHttpRequest;o.onload=function(){var n=1223===o.status?204:o.status;if(100>n||n>599)return void e(new TypeError("Network request failed"));var i={status:n,statusText:o.statusText,headers:l(o),url:r()},u="response"in o?o.response:o.responseText;t(new p(u,i))},o.onerror=function(){e(new TypeError("Network request failed"))},o.open(n.method,n.url,!0),"include"===n.credentials&&(o.withCredentials=!0),"responseType"in o&&d.blob&&(o.responseType="blob"),n.headers.forEach(function(t,e){o.setRequestHeader(e,t)}),o.send("undefined"==typeof n._bodyInit?null:n._bodyInit)})},self.fetch.polyfill=!0}}()},{}],37:[function(t,e,n){"use strict";t("whatwg-fetch");var r=t("Q"),o=t("eventemitter3"),i=t("bson-objectid"),u=t("shallow-copy"),s=t("querystring"),a=t("lodash.get"),c=t("lodash.sortByOrder"),f=t("localforage").createInstance({name:"formio",version:1,storeName:"formio",description:"The offline storage for formio data."}),l="formioCache-",p="formioSubmissionCache-",d="formioOfflineQueue";e.exports=function(t,e,n){var h=t||"",v=e||!1,y=r(),m={},b={},g=[],w=f.getItem(d).then(function(t){g=t||[]})["catch"](function(t){console.error("Failed to restore offline submission queue:",t)});y=y.thenResolve(w);var _,j=!1,k=!1,x=!1,E=function(t){return t.match(/^(http[s]?:\/\/)([^/]+)($|\/.*)/)},S=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")},I=function(t){Object.keys(t.forms).forEach(function(e){var n=t.forms[e];n&&Object.keys(t.forms).forEach(function(e){var r=t.forms[e];(n._id===r._id||n.path===r.path)&&new Date(r.modified)<new Date(n.modified)&&delete t.forms[e]})})},O=function(){return _?_:(y=y.then(function(){return _=null,f.setItem(d,g)})["catch"](function(t){console.error("Error persisting submission queue:",t)}),_=y,y)},T=function(t){return Object.keys(b).some(function(e){return b[e].forms[t]})},A=function(t,e){var n=q(t);if(!T(n.path))return r();t=n.path||n._id;var o=u(e);return o.offline=!0,f.setItem(p+t+"-"+e._id,o)["catch"](function(t){throw console.error("Failed to save offline submission:",t),t})},P=function(t,e,n){var r=q(t);return f.getItem(p+r.path+"-"+e).then(function(t){return t||f.getItem(p+r._id+"-"+e)}).then(function(t){return g.reduce(function(t,r){if((r.request._id||r.request.data._id)===e&&r!==n){if("POST"===r.request.method)return r.request.data;if("PUT"===r.request.method){var o=u(t);return o.data=r.request.data.data,o.modified=(new Date).toISOString(),o}if("DELETE"===r.request.method)return null}return t},t)})["catch"](function(t){throw console.error("Failed to retrieve offline submission:",t),t})},D=function(t,e){var n=q(t);return r.all([f.removeItem(p+n.path+"-"+e),f.removeItem(p+n._id+"-"+e)])["catch"](function(t){console.error("Failed to delete offline submission:",t)})},R=function(t,e,n){return n.indexOf(t)===e},U=function(t){var e=q(t);return g.filter(function(t){return(t.request.form===e.path||t.request.form===e._id)&&"DELETE"!==t.request.method}).map(function(t){return t.request._id||t.request.data._id}).filter(R)},q=function(t){if(i.isValid(t)){var e={_id:t,path:null};return Object.keys(b).forEach(function(n){Object.keys(b[n].forms).forEach(function(r){var o=b[n].forms[r];o._id===t&&(e={_id:t,path:r})})}),e}var e={_id:null,path:t};return Object.keys(b).forEach(function(n){var r=b[n].forms[t];r&&(e={_id:r._id,path:t})}),e},N=function(t){if(!(this instanceof N))return new N(t);if(!t)return this.projectUrl=h+"/project",this.projectsUrl=h+"/project",this.projectId=!1,void(this.query="");this.projectsUrl="",this.projectUrl="",this.projectId="",this.formUrl="",this.formsUrl="",this.formId="",this.submissionsUrl="",this.submissionUrl="",this.submissionId="",this.actionsUrl="",this.actionId="",this.actionUrl="",this.query="",0!==t.indexOf("http")&&0!==t.indexOf("//")&&(h=h?h:window.location.href.match(/http[s]?:\/\/api./)[0],t=h+t);var e=E(t),n=[],r=e[1]+e[2];t=e.length>3?e[3]:"";var o=t.split("?");if(o.length>1&&(t=o[0],this.query="?"+o[1]),-1!==t.search(/(^|\/)(form|project)($|\/)/)){var i=function(e,r){this[e+"sUrl"]=r+"/"+e;var o=new RegExp("/"+e+"/([^/]+)");return-1!==t.search(o)&&(n=t.match(o),this[e+"Url"]=n?r+n[0]:"",this[e+"Id"]=n.length>1?n[1]:"",r+=n[0]),r}.bind(this),u=function(t,e,n){for(var r in t){var o=t[r];if(o instanceof Array)u(o,e,!0);else{var s=i(o,e);e=n?e:s}}};u(["project","form",["submission","action"]],r)}else{this.projectUrl=r,this.projectId=e.length>2?e[2].split(".")[0]:"";var s=new RegExp("/(submission|action)($|/.*)"),a=t.match(s);this.pathType=a&&a.length>1?a[1]:"",t=t.replace(s,""),t=t.replace(/\/$/,""),this.formsUrl=r+"/form",this.formUrl=r+t,this.formId=t.replace(/^\/+|\/+$/g,"");var c=["submission","action"];for(var f in c){var l=c[f];this[l+"sUrl"]=r+t+"/"+l,this.pathType===l&&a.length>2&&a[2]&&(this[l+"Id"]=a[2].replace(/^\/+|\/+$/g,""),this[l+"Url"]=r+t+a[0])}}},B=function(t){var e=t+"Id",n=t+"Url";return function(o,i){return"object"==typeof o&&(o="?"+S(o.params)),this[e]?this.makeRequest(t,this[n]+this.query,"get",null,i):r.reject("Missing "+e)}},C=function(t){var e=t+"Id",n=t+"Url";return function(r,o){var i=this[e]?"put":"post",u=this[e]?this[n]:this[t+"sUrl"];return m={},this.makeRequest(t,u+this.query,i,r,o)}},L=function(t){var e=t+"Id",n=t+"Url";return function(o){return this[e]||r.reject("Nothing to delete"),m={},this.makeRequest(t,this[n],"delete",null,o)}},F=function(t){var e=t+"Url";return function(n,r){return n=n||"","object"==typeof n&&(n="?"+S(n.params)),this.makeRequest(t,this[e]+n,"get",null,r)}};return N.prototype.makeRequest=function(t,e,n,o,i){var d=this;return n=(n||"GET").toUpperCase(),i&&"object"==typeof i||(i={}),y.then(function(){if(k&&!i.skipQueue&&"submission"===t&&("POST"===n||"PUT"===n||"DELETE"===n)){var u={request:{_id:d.submissionId,type:t,url:e,method:n,data:o,form:d.formId,formUrl:d.formUrl}};return Object.defineProperty(u,"deferred",{enumerable:!1,value:r.defer()}),g.push(u),O(),N.offline.emit("queue",u.request),N.dequeueSubmissions(),u.deferred.promise}if(N.isForcedOffline()){var s=new Error("Formio is forced into offline mode.");throw s.networkError=!0,s}return N.request(e,n,o)})["catch"](function(o){if(!o.networkError)throw o;var i=b[d.projectId];if("form"===t&&"GET"===n){if(!i||!i.forms)throw o;var u=Object.keys(i.forms).reduce(function(t,e){if(t)return t;var n=i.forms[e];return n._id===d.formId||n.path===d.formId?n:void 0},null);if(!u)throw o.message+=" (No offline cached data found)",o;return u}if("forms"===t&&"GET"===n){if(!i||!i.forms)throw o;return i.forms}if("submission"===t&&"GET"===n)return P(d.formId,d.submissionId).then(function(t){if(!t)throw o;return t});if("submissions"===t&&"GET"===n)return f.keys().then(function(t){t=t.concat(U(d.formId).map(function(t){return p+d.formId+"-"+t})).filter(R);var n=q(d.formId);return r.all(t.filter(function(t){return 0===t.indexOf(p+n.path)||0===t.indexOf(p+n._id)}).map(function(t){var e=t.split("-")[2];return P(d.formId,e)})).then(function(t){t=t.filter(function(t){return t});var n=t.length,r=s.parse(e.split("?")[1]||"");if(r.sort){var o=r.sort.split(/\s+/),i=[];o=o.map(function(t){return"-"===t.charAt(0)?(i.push("desc"),t.substring(1)):(i.push("asc"),t)}),t=c(t,o,i)}Object.keys(r).forEach(function(e){var n=r[e],o=e.split("__")[1],e=e.split("__")[0],i=null;switch(e){case"sort":case"limit":case"skip":case"select":break;default:switch(o){case void 0:i=function(t){return a(t,e)==n};break;case"ne":i=function(t){return a(t,e)!=n};break;case"gt":i=function(t){return a(t,e)>n};break;case"gte":i=function(t){return a(t,e)>=n};break;case"lt":i=function(t){return a(t,e)<n};break;case"lte":i=function(t){return a(t,e)<=n};break;case"in":i=function(t){return-1!==n.split(",").indexOf(a(t,e))};break;case"regex":i=function(t){var r=n.match(/\/?([^/]+)\/?([^/]+)?/),o=new RegExp(r[1],r[2]);return a(t,e).match(o)}}}i&&(t=t.filter(i))});var u=Number(r.limit)||10,f=Number(r.skip)||0;return(0!==f||u<t.length)&&(t=t.slice(f,f+u)),t.limit=u,t.skip=f,t.serverCount=n,t})});throw o}).then(function(e){var o=b[d.projectId];if(!o)return e;if("form"!==t||"DELETE"===n||e.offline)if("form"===t&&"DELETE"===n){var i=q(d.formId),s="";o.forms.forEach(function(t){(t.path===i.path||t._id===i._id)&&(s=t.path)}),delete o.forms[s]}else{if("forms"!==t||"GET"!==n){if("submission"!==t||"DELETE"===n||e.offline){if("submission"===t&&"DELETE"===n){var i=q(d.formId);return D(d.formId,d.submissionId).then(function(){return e})}return"submissions"===t&&"GET"===n?e.length&&e[0].offline?e:r.all(e.map(A.bind(null,d.formId))).thenResolve(e):e}return A(d.formId,e).then(function(){return e})}if(e.length&&e[0].offline)return e;e.forEach(function(t){var e=u(t);e.offline=!0,o.forms[t.name]=e})}else{if(new Date(o.forms[e.name].modified)>=new Date(e.modified))return e;var a=u(e);a.offline=!0,o.forms[e.name]=a}return I(o),y=y.thenResolve(f.setItem(l+d.projectId,o))["catch"](function(t){console.error(t)}),e})},N.prototype.loadProject=B("project"),N.prototype.saveProject=C("project"),N.prototype.deleteProject=L("project"),N.prototype.loadForm=B("form"),N.prototype.saveForm=C("form"),N.prototype.deleteForm=L("form"),N.prototype.loadForms=F("forms"),N.prototype.loadSubmission=B("submission"),N.prototype.saveSubmission=C("submission"),N.prototype.deleteSubmission=L("submission"),N.prototype.loadSubmissions=F("submissions"),N.prototype.loadAction=B("action"),N.prototype.saveAction=C("action"),N.prototype.deleteAction=L("action"),N.prototype.loadActions=F("actions"),N.prototype.availableActions=function(){return N.request(this.formUrl+"/actions")},N.prototype.actionInfo=function(t){return N.request(this.formUrl+"/actions/"+t)},N.loadProjects=function(){return this.request(h+"/project")},N.request=function(t,e,n){if(!t)return r.reject("No url provided");e=(e||"GET").toUpperCase();var o=btoa(t);return y.then(function(){return"GET"===e&&m.hasOwnProperty(o)?m[o]:r().then(function(){var r=new Headers({Accept:"application/json","Content-type":"application/json; charset=UTF-8"}),o=N.getToken();o&&r.append("x-jwt-token",o);var i={method:e,headers:r,mode:"cors"};return n&&(i.body=JSON.stringify(n)),fetch(t,i)})["catch"](function(t){throw t.message="Could not connect to API server ("+t.message+")",t.networkError=!0,t}).then(function(t){if(t.ok){var e=t.headers.get("x-jwt-token");return t.status>=200&&t.status<300&&e&&""!==e&&N.setToken(e),204===t.status?{}:t.json().then(function(e){var n=t.headers.get("content-range");if(n){if(n=n.split("/"),"*"!==n[0]){var r=n[0].split("-");e.skip=Number(r[0]),e.limit=r[1]-r[0]+1}e.serverCount="*"===n[1]?n[1]:Number(n[1])}return e})}return 440===t.status&&N.setToken(null),(-1!==t.headers.get("content-type").indexOf("application/json")?t.json():t.text()).then(function(t){throw t})})["catch"](function(t){throw delete m[o],t})}).then(function(t){if("GET"===e&&(m[o]=r(t)),Array.isArray(t)){var n=t.map(u);return n.skip=t.skip,n.limit=t.limit,n.serverCount=t.serverCount,n}return u(t)})},N.setToken=function(t){if(t=t||"",t!==this.token){if(this.token=t,!t)return N.setUser(null),localStorage.removeItem("formioToken");localStorage.setItem("formioToken",t),N.currentUser()}},N.getToken=function(){if(this.token)return this.token;var t=localStorage.getItem("formioToken")||"";return this.token=t,t},N.setUser=function(t){return t?void localStorage.setItem("formioUser",JSON.stringify(t)):(this.setToken(null),localStorage.removeItem("formioUser"))},N.getUser=function(){return JSON.parse(localStorage.getItem("formioUser")||null)},N.setBaseUrl=function(t,e){h=t,v=e,N.baseUrl=h},N.clearCache=function(){m={}},N.currentUser=function(){var t=this.getUser();if(t)return r(t);var e=this.getToken();return e?this.request(h+"/current").then(function(t){return N.setUser(t),t}):r(null)},N.logout=function(){return this.request(h+"/logout")["finally"](function(){this.setToken(null),this.setUser(null),N.clearCache()}.bind(this))},N.fieldData=function(t,e){if(!t)return"";if(-1!==e.key.indexOf(".")){for(var n=t,r=e.key.split("."),o="",i=0;i<r.length;i++){if(o=r[i],n.hasOwnProperty("_id")&&(n=n.data),!n.hasOwnProperty(o))return;o===r[r.length-1]&&e.multiple&&!Array.isArray(n[o])&&(n[o]=[n[o]]),n=n[o]}return n}return e.multiple&&!Array.isArray(t[e.key])&&(t[e.key]=[t[e.key]]),t[e.key]},N.offline=new o,N.cacheOfflineProject=function(t,e){var n=new N(t),r=n.projectId,o=f.getItem(l+r).then(function(t){return t?t:e?fetch(e).then(function(t){return t.json()}).then(function(t){return t.forms=t.forms||{},Object.keys(t.resources||{}).forEach(function(e){t.forms[e]=t.resources[e]}),delete t.resources,Object.keys(t.forms).forEach(function(e){t.forms[e].created=new Date(0).toISOString(),t.forms[e].modified=new Date(0).toISOString(),t.forms[e].offline=!0}),t}):{forms:{}}});return y=y.thenResolve(o).then(function(t){return b[r]=t,f.setItem(l+r,t)})["catch"](function(t){console.error("Error trying to cache offline storage:",t)})},N.clearOfflineData=function(){b={},g=[],f.keys().then(function(t){return r.all(t.map(function(t){return 0===t.indexOf(l)||0===t.indexOf(p)?f.removeItem(t):void 0}))}).then(function(){return f.setItem(d,[])})},N.forceOffline=function(t){x=t},N.isForcedOffline=function(){return x},N.queueSubmissions=function(t){k=t},N.submissionQueueLength=function(){return g.length},N.getNextQueuedSubmission=function(){return g[0].request},N.setNextQueuedSubmission=function(t){g[0].request=t,O()},N.skipNextQueuedSubmission=function(){g.shift(),O()},N.dequeueSubmissions=function(){y.then(function(){if(!j){if(!g.length)return void N.offline.emit("queueEmpty");var t=g[0].request;j=!0;var e;if(N.isForcedOffline()){var n=new Error("Formio is forced into offline mode.");n.networkError=!0,e=r.reject(n)}else N.offline.emit("dequeue",t),e=r(N.request(t.url,t.method,t.data));return e.then(function(t){var e=g.shift();O(),"DELETE"!==e.request.method?A(e.request.form,t):D(e.request.form,e.request._id),e.deferred&&"pending"===e.deferred.promise.inspect().state?e.deferred.resolve(t):"DELETE"!==e.request.method&&N.offline.emit("formSubmission",t),j=!1,N.dequeueSubmissions()})["catch"](function(e){if(j=null,!e.networkError){var n=g[0];n.deferred&&"pending"===n.deferred.promise.inspect().state?(g.shift(),O(),n.deferred.reject(e)):N.offline.emit("formError",e,t)}n===g[0]&&N.offline.emit("requeue",t),g.forEach(function(t){if(t.deferred&&"pending"===t.deferred.promise.inspect().state){var e=N.getUser();"POST"===t.request.method?(t.request.data={_id:i.generate(),owner:e?e._id:null,offline:!0,form:t.request.form,data:t.request.data.data,created:(new Date).toISOString(),modified:(new Date).toISOString(),externalIds:[],roles:[]},t.deferred.resolve(t.request.data)):"PUT"===t.request.method?P(t.request.form,t.request._id,t).then(function(e){e.data=t.request.data.data,e.modified=(new Date).toISOString(),t.request.data=e,t.deferred.resolve(e)}):"DELETE"===t.request.method&&t.deferred.resolve({})}}),O()})}})},N}},{Q:1,"bson-objectid":6,eventemitter3:7,localforage:8,"lodash.get":9,"lodash.sortByOrder":13,querystring:5,"shallow-copy":35,"whatwg-fetch":36}]},{},[37])(37)});